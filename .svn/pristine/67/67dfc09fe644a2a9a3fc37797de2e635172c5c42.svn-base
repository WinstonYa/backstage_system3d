(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-317d3490"],{"02e3":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/welcome"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("数据管理")]),a("el-breadcrumb-item",[e._v("数据配置")])],1),a("el-card",{staticClass:"data-list-card",style:e.curHeight},[a("div",{staticClass:"el-transfer-panel"},[a("p",{staticClass:"el-transfer-panel__header"},[a("label",{staticClass:"el-checkbox"},[a("span",{staticClass:"el-checkbox__label"},[e._v("数据列表")]),a("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:e.handleAddDataDialogShow}},[e._v("新增数据")])],1)]),a("div",{staticClass:"el-transfer-panel__body"},e._l(e.dataList,(function(t,o){return a("label",{key:o,staticClass:"el-checkbox el-transfer-panel__item"},[a("el-radio",{attrs:{label:o},on:{change:function(a){return e.handleChangeDataList(t.name)}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(t.name))]),a("i",{staticClass:"el-icon-error",on:{click:e.deleteNode}})],1)})),0)]),a("div",{staticClass:"el-transfer-panel data-tree"},[a("p",{staticClass:"el-transfer-panel__header"},[a("label",{staticClass:"el-checkbox"},[a("span",{staticClass:"el-checkbox__label"},[e._v("数据目录")])])]),a("div",{staticClass:"el-transfer-panel__body"},[a("div",{staticClass:"block"},[a("el-tree",{ref:"tree",attrs:{data:e.data,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"show-checkbox":"","check-strictly":"","highlight-current":""},on:{"check-change":e.getTreeData,"node-click":e.nodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(o.title))]),a("span",[o.root?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.addNode(o)}}},[e._v(" 增加数据 ")]):e._e(),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.editNode(o)}}},[e._v(" 修改 ")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.removeNode(o)}}},[e._v(" 删除 ")])],1)])}}])})],1)])]),a("div",{staticClass:"el-transfer-panel data-content"},[a("p",{staticClass:"el-transfer-panel__header"},[a("label",{staticClass:"el-checkbox"},[a("span",{staticClass:"el-checkbox__label"},[e._v("数据内容")]),e.addRootBtn?a("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:e.addRootNode}},[e._v("添加目录")]):e._e()],1)]),a("div",{staticClass:"el-transfer-panel__body_content"},["show"==e.showTreeData?a("el-form",{ref:"treeNodeData",staticStyle:{width:"450px","margin-top":"20px"},attrs:{model:e.treeNodeData,"label-position":"left","label-width":"100px"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.treeNodeData.root,expression:"treeNodeData.root"}],attrs:{label:"能否展开"}},[a("el-switch",{attrs:{disabled:!e.editNodeShow,"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.treeNodeData.expand,callback:function(t){e.$set(e.treeNodeData,"expand",t)},expression:"treeNodeData.expand"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.treeNodeData.root,expression:"treeNodeData.root"}],attrs:{label:"是否为根"}},[a("el-switch",{attrs:{disabled:"","active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.treeNodeData.root,callback:function(t){e.$set(e.treeNodeData,"root",t)},expression:"treeNodeData.root"}})],1),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{attrs:{disabled:!e.editNodeShow},model:{value:e.treeNodeData.title,callback:function(t){e.$set(e.treeNodeData,"title",t)},expression:"treeNodeData.title"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.treeNodeData.root,expression:"!treeNodeData.root"}],attrs:{label:"名称"}},[a("el-input",{attrs:{disabled:!e.editNodeShow},model:{value:e.treeNodeData.name,callback:function(t){e.$set(e.treeNodeData,"name",t)},expression:"treeNodeData.name"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.treeNodeData.root,expression:"!treeNodeData.root"}],attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:!e.editNodeShow},model:{value:e.treeNodeData.type,callback:function(t){e.$set(e.treeNodeData,"type",t)},expression:"treeNodeData.type"}},e._l(e.typeOptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})})),1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.treeNodeData.root,expression:"!treeNodeData.root"}],attrs:{label:"数据"}},[a("el-input",{attrs:{disabled:!e.editNodeShow},model:{value:e.treeNodeData.data,callback:function(t){e.$set(e.treeNodeData,"data",t)},expression:"treeNodeData.data"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.treeNodeData.root,expression:"!treeNodeData.root"}],attrs:{label:"链接地址"}},[a("el-input",{attrs:{disabled:!e.editNodeShow},model:{value:e.treeNodeData.url,callback:function(t){e.$set(e.treeNodeData,"url",t)},expression:"treeNodeData.url"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.treeNodeData.root,expression:"!treeNodeData.root"}],attrs:{label:"默认显示"}},[a("el-switch",{attrs:{disabled:!e.editNodeShow,"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.treeNodeData.checked,callback:function(t){e.$set(e.treeNodeData,"checked",t)},expression:"treeNodeData.checked"}})],1),e.editNodeShow?a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submitEditNode}},[e._v("确认修改")]),a("el-button",{attrs:{size:"small"},on:{click:e.cancelEditNode}},[e._v("取消")])],1):e._e()],1):"addShow"==e.showTreeData?a("el-form",{ref:"addTreeNodeData",staticStyle:{width:"400px","margin-top":"20px"},attrs:{model:e.addTreeNodeData,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.addTreeNodeData.title,callback:function(t){e.$set(e.addTreeNodeData,"title",t)},expression:"addTreeNodeData.title"}})],1),a("el-form-item",{attrs:{label:"能否展开"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.addTreeNodeData.expand,callback:function(t){e.$set(e.addTreeNodeData,"expand",t)},expression:"addTreeNodeData.expand"}})],1),a("el-form-item",{attrs:{label:"是否为根"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.addTreeNodeData.root,callback:function(t){e.$set(e.addTreeNodeData,"root",t)},expression:"addTreeNodeData.root"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submitAddNode}},[e._v("确认添加")]),a("el-button",{attrs:{size:"small"},on:{click:e.cancelAddNode}},[e._v("取消")])],1)],1):e._e(),"addchildrenShow"==e.showTreeData?a("el-form",{ref:"childrenNodeData",staticStyle:{width:"450px","margin-top":"20px"},attrs:{model:e.childrenNodeData,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:e.childrenNodeData.name,callback:function(t){e.$set(e.childrenNodeData,"name",t)},expression:"childrenNodeData.name"}})],1),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.childrenNodeData.title,callback:function(t){e.$set(e.childrenNodeData,"title",t)},expression:"childrenNodeData.title"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.childrenNodeData.type,callback:function(t){e.$set(e.childrenNodeData,"type",t)},expression:"childrenNodeData.type"}},e._l(e.typeOptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})})),1)],1),a("el-form-item",{attrs:{label:"数据"}},[a("el-input",{model:{value:e.childrenNodeData.data,callback:function(t){e.$set(e.childrenNodeData,"data",t)},expression:"childrenNodeData.data"}})],1),a("el-form-item",{attrs:{label:"链接地址"}},[a("el-input",{model:{value:e.childrenNodeData.url,callback:function(t){e.$set(e.childrenNodeData,"url",t)},expression:"childrenNodeData.url"}})],1),a("el-form-item",{attrs:{label:"默认显示"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.childrenNodeData.checked,callback:function(t){e.$set(e.childrenNodeData,"checked",t)},expression:"childrenNodeData.checked"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addChildrenNode}},[e._v("确认添加")]),a("el-button",{attrs:{size:"small"},on:{click:e.cancelAddNode}},[e._v("取消")])],1)],1):e._e()],1)])]),a("el-dialog",{attrs:{title:"新增数据列表",visible:e.addDialogVisible,width:"30%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.handleCloseDialog}},[a("el-form",{ref:"dataRuleForm",attrs:{model:e.dataRuleForm,rules:e.dataRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"数据名称",prop:"dataName"}},[a("el-input",{model:{value:e.dataRuleForm.dataName,callback:function(t){e.$set(e.dataRuleForm,"dataName",t)},expression:"dataRuleForm.dataName"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddData}},[e._v("立即创建")])],1)],1)],1)},i=[],l=(a("96cf"),a("1da1")),d=a("9f86"),s={data:function(){return{data:[],curHeight:{height:""},radio:!1,dataList:[],addDialogVisible:!1,addRootBtn:!1,dataRuleForm:{dataName:""},dataRules:{dataName:[{required:!0,message:"请输入数据名称",trigger:"blur"}]},fileName:"",treeNodeData:{},addTreeNodeData:{},childrenNodeData:{},typeOptions:[{label:"3DTiles"},{label:"DEM"}],editNodeShow:!1,id:"",showTreeData:"",checked:!1,editCheckId:""}},created:function(){var e=this;this.getDataList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getDataList:function(){var e=this;d["a"].getDataList().then((function(t){200==t.status&&(e.dataList=t.data)}))},addNode:function(e){this.checked&&(this.childrenNodeData={},this.showTreeData="addchildrenShow"),e.id&&(this.childrenNodeData.pId=e.id,this.childrenNodeData.fileName=this.fileName)},addRootNode:function(){this.showTreeData="addShow",this.addTreeNodeData={fileName:this.fileName},this.checked&&(this.addTreeNodeData={fileName:this.fileName,pId:this.id})},submitAddNode:function(){var e=this;console.log(this.addTreeNodeData),d["a"].addJsonNode(this.addTreeNodeData).then((function(t){if(200==t.status){e.$message.success("添加节点成功"),e.showTreeData="show";var a=e.addTreeNodeData.fileName;e.handleChangeDataList(a)}}))},addChildrenNode:function(){var e=this;d["a"].addJsonNode(this.childrenNodeData).then((function(t){if(200==t.status){e.$message.success("添加节点成功"),e.showTreeData="show";var a=e.childrenNodeData.fileName;e.handleChangeDataList(a)}}))},cancelAddNode:function(){this.showTreeData="show"},submitEditNode:function(){var e=this;this.treeNodeData.fileName=this.fileName,console.log(this.treeNodeData),d["a"].editJsonNode(this.treeNodeData).then((function(t){200==t.status&&(e.$message.success("修改成功"),e.editNodeShow=!1)}))},cancelEditNode:function(){this.editNodeShow=!1},editNode:function(e){this.id=e.id,this.checked&&(this.editNodeShow=!0)},removeNode:function(e){var t=this,a=e.id,o=this.fileName;this.$confirm("是否删除该节点?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d["a"].delJsonChildrenNode(a,o).then((function(e){200==e.status&&(t.handleChangeDataList(o),t.$message.success("删除成功"))}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},deleteNode:function(){var e=this;this.$nextTick((function(){e.$confirm("是否删除该文件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d["a"].delJsonFile(e.fileName).then((function(t){200==t.status&&(e.getDataList(),e.data=[])}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))}))},getTreeData:function(e,t){this.editNodeShow=!1,this.checked=t,t&&(this.editCheckId=e.id,this.$refs.tree.setCheckedNodes([e]),this.showTreeData="show",this.id=e.id,this.addRootBtn=!!e.root,this.treeNodeData=e)},nodeClick:function(e,t){this.checked=t.checked},handleAddData:function(){var e=this;this.$refs.dataRuleForm.validate(function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(a){var o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:o=e.dataRuleForm.dataName,i=new FormData,i.append("fileName",o),d["a"].addDataItem(i).then((function(t){200==t.status?(e.addDialogVisible=!1,e.$message.success("新增数据成功"),e.dataRuleForm={},e.getDataList()):500==t.status&&(e.$message.warning("已存在同名文件或文件夹，请重新填写！"),e.dataRuleForm.dataName="")}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleAddDataDialogShow:function(){this.addDialogVisible=!0},handleCloseDialog:function(){this.dataRuleForm={},this.$refs.dataRuleForm.clearValidate(),this.getDataList()},handleChangeDataList:function(e){var t=this;this.addRootBtn=!!e,this.treeNodeData.fileName=e,this.fileName=e;var a=new FormData;a.append("fileName",e),d["a"].getCataContent(a).then((function(e){200===e.status?t.data=e.data:t.data=[]}))},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight.height=e-120+"px"}}},r=s,n=(a("b203"),a("2877")),c=Object(n["a"])(r,o,i,!1,null,"206dc582",null);t["default"]=c.exports},"4e81":function(e,t,a){},b203:function(e,t,a){"use strict";a("4e81")}}]);
//# sourceMappingURL=chunk-317d3490.c1e48b70.js.map